<div class="row">
    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üìä Category Distribution</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üöÄ Business Growth Journey</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="lineChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- New Card for Low Stock Products -->
    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üìâ Low Stock Products</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="barChart"></canvas>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="mb-0">üí∞ Budget Tracking</h5>
                </div>
                <div class="card-body">
                    {% if duplicate_products %}
                    <div class="table-responsive" style="overflow-x: auto; white-space: nowrap; height: 350px;">
                        <table class="table table-striped table-hover table-bordered">
                            <thead style="background: linear-gradient(to right, #5739e0, #8da1f8); color: white;">
                                <tr>
                                    <th style="color: #ffffff;">Product Name <span>üõçÔ∏è</span></th>
                                    <th style="color: #ffffff;">Category <span>üì¶</span></th>
                                    <th style="color: #ffffff;">Price <span>üí∏</span></th>
                                    <th style="color: #ffffff;">Vendor <span>üè¢</span></th>
                                </tr>
                            </thead>

                            <tbody>
                                {% for product in duplicate_products %}
                                <tr>
                                    <td>{{ product.name }}</td>
                                    <td>{{ product.category.name }}</td>
                                    <td>{{ product.price|floatformat:2 }} Rs</td> <!-- Display Price -->
                                    <td>{{ product.vendor.name }}</td> <!-- Display Vendor Name -->
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <p>No duplicate products found.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üìâ Less Sold Items</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <!-- Enable horizontal scrolling -->
                        <div class="table-responsive" style="overflow-x: auto; white-space: nowrap; height: 410px;">
                            <table class="table table-striped table-hover table-bordered">
                                <thead style="background: linear-gradient(to right, #ff7e5f, #feb47b); color: white;">
                                    <tr>
                                        <th style="color: #ffffff;">Item Name <span>üìù</span></th>
                                        <th style="color: #ffffff;">Category <span>üì¶</span></th>
                                        <th style="color: #ffffff;">Quantity <span>üìä</span></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in items_not_sold %}
                                    <tr>
                                        <td>{{ item.name }}</td>
                                        <td>{{ item.category.name }}</td>
                                        <td>{{ item.quantity }}</td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="3">No items found.</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="mb-0">üßë‚Äçüíº Customer Tracking</h5>
                </div>
                <div class="card-body">

                    <!-- Customer Loyalty Points Chart -->
                    <canvas id="loyaltyPointsChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>


    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">‚ú® Smart Tips</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <div class="tips-container">
                            <ul id="tips-list">
                                {% for tip in tips %}
                                <li>{{ tip }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="mb-0">ü§î What we can do?</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="tipsRadarChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üì¢ Recommendations For Advertisement</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive" style="overflow-x: auto; white-space: nowrap; height: 410px;">
                        <table class="table table-striped table-hover table-bordered">
                            <thead style="background: linear-gradient(to right, #ca2493, #eeaed5); color: white;">
                                <tr>
                                    <th style="color: #ffffff;">Item Name <span>üìù</span></th>
                                    <th style="color: #ffffff;">Category <span>üì¶</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in items_in_sales %}
                                <tr>
                                    <td>{{ item.name }}</td>
                                    <td>{{ item.category.name }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="4">No items found in sales.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5 class="card-title">üìà Sales Trend</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="salesTrendChart" width="1500" height="900"></canvas>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5>üìà Future Sales Products</h5>
                </div>
                <div class="card-body">
                    {% if duplicate_products %}
                    <div class="table-responsive" style="overflow-x: auto; white-space: nowrap; height: 350px;">
                        <table class="table table-striped table-hover table-bordered">
                            <thead style="background: linear-gradient(to right, #1d5533, #53eb5f); color: white;">
                                <tr>
                                    <th style="color: #ffffff;">üõí Product Name <span></span></th>
                                    <th style="color: #ffffff;">üîÆ Future Sales <span></span></th>
                                </tr>
                            </thead>

                            <tbody>
                                {% for sale in predicted_sales %}
                                <tr>
                                    <td>{{ sale.product_name }}</td>
                                    <td>{{ sale.future_sales|join:", " }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <p>No duplicate products found.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>



    <div class="card shadow border-0 mb-7 col-md-6 col-lg-6">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5>üîç Item Tag Analysis</h5>
                </div>
                <div class="card-body">
                    {% if duplicate_products %}
                    <div class="table-responsive" style="overflow-x: auto; white-space: nowrap; height: 350px;">
                        <table class="table table-striped table-hover table-bordered">
                            <thead style="background: linear-gradient(to right, #a50808, #fca5a5); color: white;">
                                <tr>
                                    <th style="color: #ffffff;">üîë Name <span></span></th>
                                    <th style="color: #ffffff;">üìù Social Tags <span></span></th>
                                </tr>
                            </thead>

                            <tbody>
                                {% for analysis in name_analysis %}
                                <tr>
                                    <td>{{ analysis.name }}</td>
                                    <td>{{ analysis.pos_tags|join:", " }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <p>No duplicate data found.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>


    <div class="card shadow border-0 mb-7 col-md-6 col-lg-12">
        <div class="card-body">
            <div class="card shadow border-0">
                <div class="card-header">
                    <h5>üåü Product Wordcloud</h5>
                </div>
                <div class="card-body">
                    <img src="data:image/png;base64,{{ wordcloud_image_data }}" alt="Word Cloud">
                </div>
            </div>
        </div>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('salesTrendChart').getContext('2d');
    const salesTrendChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ sales_trend_labels| safe }},
    datasets: [{
        label: 'Sales Trend',
        data: {{ sales_trend_values| safe }},
        borderColor: 'rgba(75, 192, 192, 1)',
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        borderWidth: 2,
        tension: 0.4,
            }]
        },
    options: {
        responsive: true,
            plugins: {
            legend: { position: 'top' },
        },
        scales: {
            x: { title: { display: true, text: 'Date' } },
            y: { title: { display: true, text: 'Quantity Sold' } }
        }
    }
    });
    // Radar chart for Smart Tips
    var tipsRadarCtx = document.getElementById('tipsRadarChart').getContext('2d');
    var tipsRadarChart = new Chart(tipsRadarCtx, {
        type: 'radar',
        data: {
            labels: {{ tips_labels| safe }},
    datasets: [{
        label: 'Tip Relevance',
        data: {{ tips_importance| safe }},
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        borderColor: 'rgba(75, 192, 192, 1)',
        borderWidth: 1,
            }]
        },
    options: {
        responsive: true,
            scales: {
            r: {
                angleLines: {
                    color: 'rgba(0, 0, 0, 0.1)'
                },
                grid: {
                    color: 'rgba(0, 0, 0, 0.1)'
                },
                pointLabels: {
                    color: '#333',
                        font: {
                        size: 14
                    }
                }
            }
        },
        plugins: {
            legend: {
                position: 'top',
                },
            tooltip: {
                callbacks: {
                    label: function(context) {
                        return context.raw + ' / 10';
                    }
                }
            }
        }
    }
    });
    // Customer Loyalty Points Chart
    var loyaltyPointsCtx = document.getElementById('loyaltyPointsChart').getContext('2d');
    var loyaltyPointsChart = new Chart(loyaltyPointsCtx, {
        type: 'pie',
        data: {
            labels: {{ customer_loyalty_data.labels | safe }},
    datasets: [{
        label: '{{ customer_loyalty_data.title }}',
        data: {{ customer_loyalty_data.data | safe }},
        backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)'],
        borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)'],
        borderWidth: 1
            }]
        },
    options: {
        responsive: true
    }
    });
    // Pie Chart with Animation
    var ctxPie = document.getElementById('pieChart').getContext('2d');
    var pieChart = new Chart(ctxPie, {
        type: 'doughnut',
        data: {
            labels: {{ categories| safe }},
    datasets: [{
        data: {{ category_counts| safe }},
        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#E7E9ED', '#8E5EA2'],
        borderWidth: 1
            }]
        },
    options: {
        responsive: true,
            plugins: {
            legend: {
                position: 'bottom',
                    labels: {
                    usePointStyle: true,
                        padding: 10
                }
            },
            tooltip: {
                callbacks: {
                    label: function(tooltipItem) {
                        return tooltipItem.label + ': ' + tooltipItem.raw;
                    }
                }
            },
            title: {
                display: true,
                    text: 'Category Distribution',
                        font: {
                    size: 16
                }
            }
        },
        cutout: '60%',
            maintainAspectRatio: false,
                animation: {
            animateScale: true,
                animateRotate: true
        }
    }
    });

    // Line Chart with Animation
    var ctxLine = document.getElementById('lineChart').getContext('2d');
    var lineChart = new Chart(ctxLine, {
        type: 'line',
        data: {
            labels: {{ sale_dates_labels| safe }},
    datasets: [{
        label: 'Growth Trend',
        data: {{ sale_dates_values| safe }},
        fill: false,
        borderColor: '#4BC0C0',
        tension: 0.1
            }]
        },
    options: {
        responsive: true,
            plugins: {
            legend: {
                position: 'top',
                },
            tooltip: {
                callbacks: {
                    label: function(tooltipItem) {
                        return 'Sales: ' + tooltipItem.raw;
                    }
                }
            },
            title: {
                display: true,
                    text: 'Business Growth Trend',
                        font: {
                    size: 16
                }
            }
        },
        maintainAspectRatio: false,
            animation: {
            duration: 1500,
                easing: 'easeInOutCubic'
        }
    }
    });

    // Bar Chart with Animation
    var ctxBar = document.getElementById('barChart').getContext('2d');
    var barChart = new Chart(ctxBar, {
        type: 'bar',
        data: {
            labels: {{ low_stock_items_names| safe }},
    datasets: [{
        label: 'Low Stock Products',
        data: {{ low_stock_items_counts| safe }},
        backgroundColor: '#FF5733',
        borderColor: '#FF5733',
        borderWidth: 1
            }]
        },
    options: {
        responsive: true,
            plugins: {
            legend: {
                position: 'top',
                },
            tooltip: {
                callbacks: {
                    label: function(tooltipItem) {
                        return 'Stock: ' + tooltipItem.raw;
                    }
                }
            },
            title: {
                display: true,
                    text: 'Low Stock Products',
                        font: {
                    size: 16
                }
            }
        },
        maintainAspectRatio: false,
            animation: {
            duration: 2000,
                easing: 'easeInOutElastic'
        }
    }
    });
</script>

<style>
    .animated-card {
        background: linear-gradient(135deg, #ffffff, #f7f7f7);
        border-radius: 15px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .tips-container {
        height: 90%;
        /* Set a fixed height for the container */
        overflow: hidden;
        position: relative;
        border: 1px solid #eaeaea;
        border-radius: 10px;
        padding: 10px;
        background: #ffffff;
    }

    #tips-list {
        position: absolute;
        animation: slide-up 10s linear infinite;
        list-style: none;
        padding: 0;
        margin: 0;
    }

    /* Duplicate the tips to create an infinite loop */
    #tips-list::after {
        content: attr(data-tips);
        display: block;
    }

    #tips-list li {
        padding: 10px 0;
        font-size: 1rem;
        color: #555;
        text-align: center;
        background: rgba(74, 144, 226, 0.1);
        margin: 5px 0;
        border-radius: 8px;
        transition: background 0.3s ease, transform 0.3s ease;
    }

    #tips-list li:hover {
        background: rgba(74, 144, 226, 0.2);
        transform: scale(1.05);
    }

    @keyframes slide-up {
        0% {
            transform: translateY(0%);
        }

        100% {
            transform: translateY(-50%);
            /* Only scroll halfway to repeat */
        }
    }


    .chart-container {
        position: relative;
        width: 100%;
        height: 400px;
    }

    #pieChart,
    #lineChart,
    #barChart {
        max-width: 100%;
        height: 100%;
    }

    /* Styling for specific scrollable elements */
    .table-responsive {
        overflow-x: auto;
        white-space: nowrap;
        max-height: 350px;
        /* Restrict the height of scrollable tables */
        scrollbar-width: thin;
        /* For Firefox - thin scrollbar */
        scrollbar-color: #bac1d6 #f1f1f1;
        /* Thumb and track color for Firefox */
    }

    .table {
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f9f9f9;
    }

    .table-hover tbody tr:hover {
        background-color: #f1f1f1;
    }

    .table-bordered {
        border: 1px solid #ddd;
    }

    /* Styling for emojis */
    th span,
    td span {
        font-size: 1.2em;
        margin-left: 5px;
    }
</style>